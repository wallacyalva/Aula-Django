!function(){var e={},t=null;function n(e){return this.enqueue=function(t,n,o){var r={data:t,config:n,resolver:o||function(){}};if(!o&&window.Promise)return new window.Promise((function(t){r.resolver=t,e.push([r.data,r.config,r.resolver])}));e.push([t,n,o])},this.sizeOf=function(){return e.length},this.consume=function(){return e.splice(0,e.length)},this}function o(e,t){if(!t)throw new Error("You must provide a queue to watch");var n=e,o=-1,r=null,s=t,i=!1;this.isWatching=!1,this.startWatching=function(e){r=e,this.processQueue(),window.clearInterval(o),this.isWatching=!0,o=window.setInterval(this.processQueue.bind(this),n)},this.stopWatching=function(){this.processQueue(),this.isWatching=!1,clearInterval(o)},this.processQueue=function(){if(!i){i=!0;var e=s.consume();r&&e.length>0&&r(e),i=!1}}}window.__lter=window.__lter||{q:[],trackEvent:function(){}},e._globalVar="__lter",e.LOCAL_STORAGE_NAME="browserId",e._retryMax=5;var r=function(){var e,t=[];for(let e=0;e<256;++e)t.push((e+256).toString(16).substr(1));var n=new Uint8Array(16);return function(){var o=function(){if(!e&&!(e="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return e(n)}();return o[6]=15&o[6]|64,o[8]=63&o[8]|128,function(e,n=0){return(t[e[n+0]]+t[e[n+1]]+t[e[n+2]]+t[e[n+3]]+"-"+t[e[n+4]]+t[e[n+5]]+"-"+t[e[n+6]]+t[e[n+7]]+"-"+t[e[n+8]]+t[e[n+9]]+"-"+t[e[n+10]]+t[e[n+11]]+t[e[n+12]]+t[e[n+13]]+t[e[n+14]]+t[e[n+15]]).toLowerCase()}(o)}}();e.version=1,e.sendEvent=function(t,n,o,s){s=s||function(){};var i=!1,a=e.getSessionId(r,o);if(a&&!o.sessionId&&(1===e.version?o.sessionId=a:2===e.version&&o.eventPayload?o.eventPayload.sessionId=a:o.browser&&(o.browser.sessionId=a)),n&&!o.browserId&&(1===e.version?o.browserId=n:2===e.version&&o.eventPayload?o.eventPayload.browserId=n:o.browser&&(o.browser.browserId=n)),e.updateSessionExpiry(o),n&&navigator&&navigator.sendBeacon&&"function"==typeof navigator.sendBeacon&&navigator.sendBeacon(t,JSON.stringify(o)))return i=!0,void setTimeout((function(){s(null,{browserId:n})}),1e3);if(!i&&window.fetch&&"CREATE"!==o.eventType)try{fetch(t,{method:"POST",mode:"cors",cache:"no-cache",keepalive:!0,headers:{"Content-Type":"application/json"},redirect:"follow",body:JSON.stringify(o)}).then((function(e){if(e.ok)return e.json();throw new Error("Response from server not ok.")})).then((function(e){s(null,e?e.data:{})})).catch((function(n){e.doTraditionalXHR(t,o,s)}))}catch(n){e.doTraditionalXHR(t,o,s)}else i||e.doTraditionalXHR(t,o,s)},e.doTraditionalXHR=function(t,n,o){var r=new window.XMLHttpRequest;r.open("POST",t,!0),r.setRequestHeader("Content-Type","application/json"),r.onreadystatechange=e.xhrCallback(o),r.send(JSON.stringify(n))},e.xhrCallback=function(e){return function(){if(4===this.readyState)if(this.status>=200&&this.status<400)try{var t=JSON.parse(this.response);if(200!==t.statusCode)throw new Error("Invalid response code from server");e(null,t.data)}catch(t){e(t,null)}else e(new Error("Server responded with error"),null)}},e.getCookie=function(e){if(e){var t={browserId:void 0},n=e.split(/; */);for(var o in n){var r=n[o].split("="),s=r[0],i=decodeURIComponent(r[1]);t[s]=i}return t.browserId}},e.getBackup=function(){return window.localStorage.getItem("browserId")||null},e.getBrowserId=function(t,n){var o=e.getCookie(document.cookie)||e.getBackup()||t();if(o)return e.storeBrowserId(o),void n(null,o);throw new Error("VanillaCEP: Unable to fetch or generate browserId")},e.storeBrowserId=function(e){const{host:t}=window.location,n=t.endsWith("linktr.ee");document.cookie=`browserId=${e}; path=/; max-age=31536000; expires=Tue, 30 Mar 2099 03:14:07 GMT; samesite=none;secure;${n?" domain=linktr.ee;":""}`,window.localStorage.setItem("browserId",e)},e.processItems=function(n,o){for(;n.length>0;){var r=n.shift();e.sendEvent(r[1].endpoint,t,r[0],(function(){r[2]()}))}o&&o(null,!0)},e.unmungeAnalyticsUrl=function(e){if(e){var t=e.substr(0,Math.ceil(e.length/2));return[e.substr(Math.ceil(e.length/2),e.length).split("").reverse().join(""),t].join("")}},e.getDataUrlFromDocumentElement=function(){var t=document.getElementById("__ltcep");if(t&&"script"===t.tagName.toLowerCase())return e.unmungeAnalyticsUrl(t.attributes["data-url"].value)},e.getVersionIfPresent=function(){var e=document.getElementById("__ltcep");return e&&"script"===e.tagName.toLowerCase()&&e.attributes["data-version"]?parseInt(e.attributes["data-version"].value):1},e.getSessionId=function(t,n){var o=e.getSessionExpiry(),r=Date.parse(n.createdAt);if(isNaN(r)&&(r=Date.now(),n.createdAt=(new Date).toISOString()),!o||r>o.getTime()){var s=t();e.storeSessionId(s),e.storeSessionStart(new Date(r))}return e.getCookieValue("sessionId")},e.storeSessionId=function(e){const{host:t}=window.location,n=t.endsWith("linktr.ee");document.cookie=`sessionId=${e}; path=/; max-age=31536000; expires=Tue, 30 Mar 2099 03:14:07 GMT; samesite=none;secure;${n?" domain=.linktr.ee;":""}`,window.localStorage.setItem("sessionId",e)},e.getCookieValue=function(e){const t=("; "+document.cookie).split(`; ${e}=`);return 2===t.length?t.pop().split(";").shift():null},e.getSessionExpiry=function(){var t=e.getCookieValue("sessionExpiry");return t?new Date(t):null},e.storeSessionExpiry=function(e){const{host:t}=window.location,n=t.endsWith("linktr.ee");document.cookie=`sessionExpiry=${e.toString()}; path=/; expires=${e.toUTCString()}; samesite=none;secure;${n?" domain=.linktr.ee;":""}`,window.localStorage.setItem("sessionExpiry",e.toString())},e.storeSessionStart=function(e){const{host:t}=window.location,n=t.endsWith("linktr.ee");document.cookie=`sessionStart=${e.toString()}; path=/; expires=Tue, 30 Mar 2099 03:14:07 GMT; samesite=none;secure;${n?" domain=.linktr.ee;":""}`,window.localStorage.setItem("sessionStart",e.toString())},e.updateSessionExpiry=function(t){var n=Date.parse(t.createdAt),o=new Date(n+18e5);e.storeSessionExpiry(o)},e.syncSessionDataFromCookies=function(){const t=e.getCookieValue("sessionId");t&&window.localStorage.setItem("sessionId",t);const n=e.getCookieValue("sessionStart");n&&window.localStorage.setItem("sessionStart",n);const o=e.getCookieValue("sessionExpiry");o&&window.localStorage.setItem("sessionExpiry",o)};var s=function(e,n,o,r,s){e.syncSessionDataFromCookies(),window.__lter&&(window.__lter.trackEvent=n.enqueue.bind(n)),r||(r=e.getDataUrlFromDocumentElement()),e.version=e.getVersionIfPresent(),e.getBrowserId(s,(function(n,r){t=r,o.startWatching(e.processItems)}))};if("undefined"==typeof module||"object"!=typeof module.exports){var i=new n(window.__lter.q),a=new o(200,i);document.addEventListener("visibilitychange",(function(){"hidden"==document.visibilityState&&a.processQueue()})),window.addEventListener("pagehide",a.processQueue),window.addEventListener("unload",a.processQueue),s(e,i,a,null,r)}else module.exports={init:s,api:e,EventQueue:n,Watcher:o,uuidv4:r}}(window);
